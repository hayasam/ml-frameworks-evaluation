ARG BASE_IMAGE_VERSION
FROM emiliorivera/pytorch-lttng:${BASE_IMAGE_VERSION}

SHELL [ "/bin/bash", "-c" ]
ENV CONDA_TRAIN_ENV=train
RUN source /etc/profile.d/conda.sh && \
    conda create --channel defaults --channel pytorch --name "${CONDA_TRAIN_ENV}" --file /build/conda_build_requirements.txt

WORKDIR /ml-frameworks-evaluation

ADD src/client client
ADD src/shared shared
ADD src/client.sh .

ENTRYPOINT [ "/ml-frameworks-evaluation/client.sh" ]